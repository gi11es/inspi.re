<?php/*        Copyright (C) 2008-2009 Gilles Dubuc (www.kouiskas.com - gilles@dubuc.fr)               Resets the picture entered into a competition*/require_once(dirname(__FILE__).'/../entities/picture.php');require_once(dirname(__FILE__).'/../entities/entry.php');require_once(dirname(__FILE__).'/../entities/entrylist.php');require_once(dirname(__FILE__).'/../entities/picture.php');require_once(dirname(__FILE__).'/../entities/user.php');require_once(dirname(__FILE__).'/../constants.php');if (isset($_REQUEST['cid'])) {	$cid = $_REQUEST['cid'];	$user = User::getSessionUser();	$uid = $user->getUid();		switch ($user->getStatus()) {		case $USER_STATUS['UNREGISTERED']:			$status = $ENTRY_STATUS['ANONYMOUS'];			break;		case $USER_STATUS['BANNED']:			$status = $ENTRY_STATUS['BANNED'];			break;		default:			$status = $ENTRY_STATUS['POSTED'];	}		$entrylist = EntryList::getByUidAndCidAndStatus($uid, $cid, $status);	if (empty($entrylist))		$entrylist = EntryList::getByUidAndCidAndStatus($uid, $cid, $ENTRY_STATUS['DISQUALIFIED']);		// We delete any entry that was there before	$givepoints = 0;	if (!empty($entrylist)) foreach ($entrylist as $eid) {		$entry = Entry::get($eid);		$givepoints += $entry->getDeletionPoints();		$entry->delete();	}		$user->givePoints($givepoints);		echo $GRAPHICS_PATH.'default-community-picture-big.png';}?>